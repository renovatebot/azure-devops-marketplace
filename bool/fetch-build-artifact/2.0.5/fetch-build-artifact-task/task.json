{
	"id": "eac0431e-6ffc-4dc6-be6e-d296e9686ca6",
	"name": "fetch-build-artifact",
	"friendlyName": "Fetch Build Artifacts",
	"description": "Fetch build artifacts from the server",
	"helpMarkDown": "Requires **Allow Scripts to Access OAuth Token** to be **enabled**.<br/><br>Having Problems? Please <a href='https://github.com/BoolBySigma/FetchBuildArtifact/issues' target='_blank'>create an issue on our Github</a> and we will try to help you.",
	"category": "Utility",
	"author": "Bool (by Sigma)",
	"version": {
		"Major": 2,
		"Minor": 0,
		"Patch": 5
	},
	"instanceNameFormat": "Fetch Artifact: $(artifactName)",
	"inputs": [
		{
			"name": "connection",
			"type": "connectedService:FetchBuildArtifact",
			"label": "Connection",
			"required": true,
			"helpMarkDown": "Service endpoint connection to your Visual Studio Team Services account."
		},
		{
			"name": "project",
			"type": "string",
			"label": "Project",
			"defaultValue": "",
			"required": true,
			"helpMarkDown": "Project from where to fetch the build artifact."
		},
		{
			"name": "buildDefinition",
			"type": "pickList",
			"label": "Build Definition",
			"defaultValue": "",
			"required": true,
			"helpMarkDown": "Build definition from where to fetch build artifact.",
			"properties": {
				"EditableOptions": "False"
			}
		},
		{
			"name": "artifactName",
			"type": "string",
			"label": "Build Artifact Name",
			"defaultValue": "",
			"required": true,
			"helpMarkDown": "Name of the artifact to fetch, eg. 'drop'."
		},
		{
			"name": "targetDirectory",
			"type": "filePath",
			"label": "Target Folder",
			"defaultValue": "",
			"required": false,
			"helpMarkDown": "The directory where to download the artifact. Must be an existing directory. Leaving it blank defaults to source root directory and is equal to using <code>$(Build.SourcesDirectory)</code>."
		}
	],
	"sourceDefinitions": [
		{
			"target": "buildDefinition",
			"endpoint": "$(project)/_apis/build/definitions?queryOrder=3#$(connection)",
			"selector": "jsonpath:$.value[*].name",
			"keySelector": "jsonpath:$.value[*].id",
			"authKey": "$(connection)"
		}
	],
	"execution": {
		"PowerShell3": {
			"target": "$(currentDirectory)\\fetch.ps1",
			"argumentFormat": "",
			"workingDirectory": "$(currentDirectory)"
		}
	}
}