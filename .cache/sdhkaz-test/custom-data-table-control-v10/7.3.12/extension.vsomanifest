{
    "manifestVersion": 1,
    "scopes": [
        "vso.work"
    ],
    "contributions": [
        {
            "id": "custom-data-table-control-dt-v3",
            "type": "ms.vss-work-web.work-item-form-control",
            "targets": [
                "ms.vss-work-web.work-item-form"
            ],
            "description": "Adds a custom work item form control that shows an editable DataTables grid.",
            "properties": {
                "name": "Custom Data Table (DataTables) v3",
                "uri": "dist/index.html",
                "height": 380
            },
            "inputs": [
                {
                    "id": "DataFieldRefName",
                    "name": "Data field (reference name)",
                    "description": "Pick the field to store JSON (e.g., Custom.DataTableJSON).",
                    "type": "WorkItemField",
                    "defaultValue": "Custom.DataTableJSON",
                    "properties": {
                        "workItemFieldTypes": [
                            "String",
                            "PlainText",
                            "Html"
                        ]
                    },
                    "validation": {
                        "dataType": "String",
                        "isRequired": false
                    }
                },
                {
                    "id": "DataFieldRefNameText",
                    "name": "Data field (manual entry)",
                    "description": "If the picker doesn't render, type the field ref name (e.g., Custom.DataTableJSON).",
                    "type": "string",
                    "defaultValue": "Custom.DataTableJSON",
                    "validation": {
                        "dataType": "String",
                        "isRequired": true
                    }
                },
                {
                    "id": "SchemaJson",
                    "name": "Schema JSON (optional)",
                    "description": "Optional default column schema. Example: [{\"key\":\"name\",\"header\":\"Item Name\",\"type\":\"string\"},{\"key\":\"estimate\",\"header\":\"Estimate (hrs)\",\"type\":\"number\"},{\"key\":\"done\",\"header\":\"Done?\",\"type\":\"boolean\"}]  â€” Used only when the field is empty.",
                    "type": "string",
                    "defaultValue": "",
                    "validation": {
                        "dataType": "String",
                        "isRequired": false
                    },
                    "properties": {
                        "resizable": true,
                        "lines": 5
                    }
                },
                {
                    "id": "AllowUserSchemaEditing",
                    "name": "Allow users to edit columns",
                    "description": "If disabled, the schema is locked to what admin provides or what's already in the field.",
                    "type": "boolean",
                    "defaultValue": true
                },
                {
                    "id": "SaveShape",
                    "name": "Save format",
                    "description": "Auto: legacy array when the default 3-column schema is used; otherwise object with {schema, rows}.",
                    "type": "pickList",
                    "defaultValue": "auto",
                    "properties": {
                        "options": [
                            {
                                "id": "auto",
                                "text": "Auto (recommended)"
                            },
                            {
                                "id": "object",
                                "text": "Object with schema + rows"
                            },
                            {
                                "id": "legacyArray",
                                "text": "Legacy array (rows only)"
                            }
                        ]
                    }
                }
            ]
        }
    ],
    "contributionTypes": []
}